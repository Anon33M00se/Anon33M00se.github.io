<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=0.5" />
<title>How is this site made?</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css"/>
                                            <link rel="stylesheet" type="text/css" href="/static/css/customizations.css" />
                                            <link rel="stylesheet" type="text/css" href="/static/css/org-html-styling.css" />
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<header>
  <h1>Stuff</h1>
  <p><i>noun</i> 1. things which need to be put somewhere.</p>
  <div class="topbar-menu-container">
    <span><a href="/index.html">home</a></span> |
    <!--  <span><a href="/enough.html">enough</a></span> | --!>
    <span><a href="/itch.html">itch</a></span> | 
    <span><a href="/email.html">email</a></span> | 
    <span><a href="/totp.html">totp</a></span> | 
    <span><a href="/Books/RootsThatBind/">roots</a></span> | 
    <span><a href="/pta.html">pta</a></span> | 
    <span><a href="/how.html">how?</a></span> 
  </div>
</header>
<div id="outline-container-org7884d3c" class="outline-2">
<h2 id="org7884d3c">How does this site work?</h2>
<div class="outline-text-2" id="text-org7884d3c">
<p>
A few people have asked me about how I manage this site. It changes
frequently, as I will often throw stuff up very quickly, move it
around, and take it down again.
</p>

<p>
The whole system is managed by editing local files in Emacs and then a
couple of quick keystrokes push out any changes to free web-hosting on
GitHub. I'll explain each of the pieces in turn.
</p>
</div>
</div>


<div id="outline-container-org54bc895" class="outline-2">
<h2 id="org54bc895">It Starts with Org Mode</h2>
<div class="outline-text-2" id="text-org54bc895">
<p>
Org-mode is a part of Emacs, and is a whole ecosystem for, well,
organizing information. <a href="https://orgmode.org/">Org</a> files are just plain text with some
formatting conventions that superficially are not unlike
<a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a>. Here's an example:
</p>

<div class="org-src-container">
<pre class="src src-code">* How does this site work?

A few people have asked me about how I manage this site. It changes
frequently, as I will often throw stuff up very quickly, move it
around, and take it down again.

The whole system is managed by editing local files in Emacs and then a
couple of quick keystrokes push out any changes to free web-hosting on
GitHub. I'll explain each of the pieces in turn.


* It Starts with Org Mode

Org-mode is a part of Emacs, and is a whole ecosystem for, well,
organizing information. [[https://orgmode.org/][Org]] files are
just plain text with some formatting conventions that superficially
are not unlike [[https://en.wikipedia.org/wiki/Markdown][Markdown]].
Here's an example:
</pre>
</div>

<p>
That is the exact content that this page starts with. Because I spend
most of my day in Emacs already (see <a href="https://stuff.sigvaldason.com/email.html">email</a>), it is super easy to just
pop into an org file, make some edits (or create a new file) and
automatically push the changes out to "production".
</p>

<p>
You can specify a lot of different formats in Org-mode very easily. For example:
</p>

<div class="org-src-container">
<pre class="src src-code">
*bold*, _underline_, +strikethrough+, /italics/

| n | n^2 | n^3 |
|---+-----+-----|
| 1 |   1 |   1 |
| 2 |   4 |   8 |
| 3 |   9 |  27 |

$y=x^2$
</pre>
</div>

<p>
produces:
</p>

<p>
<b>bold</b>, <span class="underline">underline</span>, <del>strikethrough</del>, <i>italics</i>
</p>

<table>


<colgroup>
<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">n</th>
<th scope="col" class="org-right">n<sup>2</sup></th>
<th scope="col" class="org-right">n<sup>3</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">4</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">9</td>
<td class="org-right">27</td>
</tr>
</tbody>
</table>

<p>
\(y=x^2\)
</p>

<p>
This is just scratching the surface or Org-mode. To quote from the <a href="https://orgmode.org/worg/org-faq.html">Org FAQ</a>:
</p>

<blockquote>
<p>
In its default setup, Org-mode offers a simple outlining and task
management environment. But it also has a huge number of features and
settings "under the hood." Advanced users have configured Org-mode for
almost every conceivable use scenario.
</p>
</blockquote>
</div>
</div>


<div id="outline-container-orge42ceaa" class="outline-2">
<h2 id="orge42ceaa">Add in Some Packages</h2>
<div class="outline-text-2" id="text-orge42ceaa">
<p>
Emacs has a notion of packages, and there a few available for
automating the translation of org files into html. In fact, Org-mode
has built-in exporting to a number of different formats, including
\(\LaTeX\), PDF, ODT/Word, and html. While the default html output from
Org is serviceable, there is a more powerful package available that is
more flexible, produces nicer html output, and helps keep various
ancillary files organized.
</p>

<p>
The main package for this is ox-publish, which is really part of
Org-mode itself. You can create an elisp file (a bit of interpretable
code written in Emacs's own variant of the Lisp programming language)
that:
</p>

<ol class="org-ol">
<li>Makes sure ox-publish is in place</li>

<li>Describes where the source (.org) files for the site are located (relative to the directory where the elisp script is).</li>

<li>Describes the "publishing" directory where html output files should end up.</li>

<li>Sets various other optional parameters (e.g. css style sheets to use, etc.)</li>

<li>Runs the actual page creation process.</li>
</ol>

<p>
Then, any time you make any edits or structural changes to the
underlying org document, you just invoke this script to automagically
process all the changes.
</p>

<p>
There are many other things you can do within ox-publish. The exact
script I use for this site is in the code block below, and I include
resources at the end of this document where you can find more details
on all the configuration options available.
</p>

<div class="org-src-container">
<pre class="src src-elisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">
</span><span class="org-comment-delimiter">;; </span><span class="org-comment">Bring in the package system (elpa/melpa), make sure that is not
</span><span class="org-comment-delimiter">;; </span><span class="org-comment">messing with our normal (user) package dir but is doing so in the
</span><span class="org-comment-delimiter">;; </span><span class="org-comment">local .packages directory, and then bring in htmlize (mostly for
</span><span class="org-comment-delimiter">;; </span><span class="org-comment">syntax highlighting in code blocks).
</span><span class="org-comment-delimiter">;;</span><span class="org-comment">
</span>
(<span class="org-keyword">require</span> '<span class="org-constant">package</span>)
(<span class="org-keyword">setq</span> package-user-dir (expand-file-name <span class="org-string">"./.packages"</span>))
(<span class="org-keyword">setq</span> package-archives '((<span class="org-string">"melpa"</span> . <span class="org-string">"https://melpa.org/packages/"</span>   )
                         (<span class="org-string">"elpa"</span>  . <span class="org-string">"https://elpa.gnu.org/packages"</span> )))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Init the package system
</span>(package-initialize)
(<span class="org-keyword">unless</span> package-archive-contents
  (package-refresh-contents))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Install dependencies
</span>(package-install 'htmlize)

<span class="org-comment-delimiter">;;</span><span class="org-comment">
</span><span class="org-comment-delimiter">;; </span><span class="org-comment">Load the publishing system
</span><span class="org-comment-delimiter">;;</span><span class="org-comment">
</span>(<span class="org-keyword">require</span> '<span class="org-constant">ox-publish</span>)

(<span class="org-keyword">setq</span> org-html-validation-link             nil <span class="org-comment-delimiter">;; </span><span class="org-comment">don't show a "Validate" link at the bottom of the page
</span>      org-html-head-include-scripts        nil <span class="org-comment-delimiter">;; </span><span class="org-comment">don't put default org-html export scripts in place
</span>      org-html-doctype                     <span class="org-string">"html5"</span>
      org-html-html5-fancy                 t
      org-html-head-include-default-style  nil <span class="org-comment-delimiter">;; </span><span class="org-comment">skip the default style sheet
</span>      org-html-viewport                    '((width <span class="org-string">"device-width"</span>)
                                             (initial-scale <span class="org-string">"0.5"</span>)
                                             (minimum-scale <span class="org-string">""</span>)
                                             (maximum-scale <span class="org-string">""</span>)
                                             (user-scalable <span class="org-string">""</span>))

      org-html-head                        <span class="org-string">"&lt;link rel=\"stylesheet\" href=\"https://cdn.simplecss.org/simple.min.css\"/&gt;
                                            &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/css/customizations.css\" /&gt;
                                            &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/css/org-html-styling.css\" /&gt;"</span>
                                            <span class="org-comment-delimiter">;; </span><span class="org-comment">^ This last file is generated by running org-html-htmlize-generate-css
</span>      <span class="org-comment-delimiter">;;</span><span class="org-comment">org-html-head                       "&lt;link rel=\"stylesheet\" href=\"https://latex.vercel.app/style.css\" /&gt;"
</span>      <span class="org-comment-delimiter">;;</span><span class="org-comment">org-html-head                       "&lt;link rel=\"stylesheet\" href=\"/css/latex.css\" /&gt;"
</span>      <span class="org-comment-delimiter">;;</span><span class="org-comment">org-html-htmlize-output-type        'inline-css
</span>      org-html-htmlize-output-type          'css

  )

(<span class="org-keyword">setq</span> org-publish-project-alist
  (list
   (list <span class="org-string">"stuff"</span>
     <span class="org-builtin">:recursive</span> t
     <span class="org-builtin">:base-directory</span> <span class="org-string">"./content"</span>
     <span class="org-builtin">:base-extension</span> <span class="org-string">"org"</span>
     <span class="org-builtin">:publishing-directory</span> <span class="org-string">"./public"</span>
     <span class="org-builtin">:publishing-function</span> 'org-html-publish-to-html
     <span class="org-builtin">:with-author</span> nil
     <span class="org-builtin">:with-title</span> nil
     <span class="org-builtin">:with-creator</span> t
     <span class="org-builtin">:with-toc</span> nil
     <span class="org-builtin">:section-numbers</span> nil
     <span class="org-builtin">:time-stamp-file</span> t)
   (list <span class="org-string">"static"</span>
     <span class="org-builtin">:recursive</span> t
     <span class="org-builtin">:base-directory</span> <span class="org-string">"./static"</span>
     <span class="org-builtin">:base-extension</span> <span class="org-string">"css</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">js</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">pdf</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">png"</span>
     <span class="org-builtin">:publishing-directory</span> <span class="org-string">"./public/static"</span>
     <span class="org-builtin">:publishing-function</span> 'org-publish-attachment
     <span class="org-builtin">:with-author</span> nil
     <span class="org-builtin">:with-title</span> nil
     <span class="org-builtin">:with-creator</span> t
     <span class="org-builtin">:with-toc</span> nil
     <span class="org-builtin">:section-numbers</span> nil
     <span class="org-builtin">:time-stamp-file</span> t)))

(org-publish-all t)


(message <span class="org-string">"Build complete!"</span>)

</pre>
</div>




<p>
The htmlize package is included in there so that if I have a code block in a given file, like this python file:
</p>

<div class="org-src-container">
<pre class="src src-python">
<span class="org-keyword">from</span> fastapi <span class="org-keyword">import</span> FastAPI

<span class="org-variable-name">app</span> <span class="org-operator">=</span> FastAPI()

<span class="org-type">@app.get</span>(<span class="org-string">"/"</span>)
<span class="org-keyword">async def</span> <span class="org-function-name">root</span>():
    <span class="org-keyword">return</span> {<span class="org-string">"message"</span>: <span class="org-string">"Hello, World!"</span>}

</pre>
</div>

<p>
I get syntax highlighting in the exported html automatically without having to do anything further. 
</p>
</div>
</div>


<div id="outline-container-org594287d" class="outline-2">
<h2 id="org594287d">Hosting at Github (plus Actions)</h2>
<div class="outline-text-2" id="text-org594287d">
<p>
Everything up to this point has been about creating content in org
format and then automatically converting it into nice looking html. To
host it at github, we need a couple of more pieces in place.
</p>

<p>
The first step is to get a <a href="https://github.com/signup">github account</a>. Even if you already have an
account for other purposes, it might make sense to have a separate one
just for hosting a site (it's somewhat more complicated to juggle
projects, repositories, and github pages when you only want to host a
website for one repository from a given account, but it can <a href="https://deanattali.com/blog/multiple-github-pages-domains/">be done</a>).
</p>

<p>
Once you've got the github account setup, you should create a
repository in that account with a name that consists of your username
plus "github.io", like this:
</p>

<p>
&nbsp;&nbsp;&nbsp;&nbsp; <b><i>username</i>.github.io</b>
</p>

<p>
Then use git (or the Emacs module <a href="https://magit.vc/">magit</a>) to sync all the org files,
directory structure, build script, etc. to the newly created
repository.
</p>

<p>
Now you can take advantage of github's free web-hosting service
(called <a href="https://pages.github.com/">Github Pages</a>) to serve the files via a "Continuous
Integration" (CI) process. CI is often spoken of in hushed tones that
suggest complex processes involving infrastructure and platform
systems to automatically deploy very sophisticated systems. All it
means in this context is that github will automatically run a script
every time you push new changes to the repository. In particular, if
you make a directory inside <b>.github</b> called <b>workflows</b>, any
yaml file placed in there will automatically be processed by github
after a push. So if we have a file like this called <b>./github/workflows/publish.yml</b>:
</p>

<div class="org-src-container">
<pre class="src src-elisp">
name: Publish to GitHub Pages

on: [push]

permissions:
  contents: write

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - name: Check out
        uses: actions/checkout@v1

      - name: Install Emacs
        run: sudo apt install emacs-nox --yes

      - name: Build the site
        run: ./build.sh

      - name: Publish generated content to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: public


</pre>
</div>

<p>
Processing that yaml will invoke a virtual machine at github running
ubuntu ("<b>runs-on: ubuntu-latest</b>"). On that vm, we will actually
quickly install emacs ("<b>run: sudo apt install emacs-nox &#x2013;yes</b>") and
then run a script ("<b>run ./build.sh</b>:) which is just a shell wrapper
around the ox-publish script from above. It looks like this:
</p>

<div class="org-src-container">
<pre class="src src-org">#!/bin/sh
emacs -Q --script build-site.el
</pre>
</div>

<p>
This will then regenerate all the site content in the <b>./public</b>
directory of our repository. The yaml file then says to use a very
popular github action (defined in
<b>JamesIves/github-pages-deploy-action@v4</b>) to push the content in the
<b>/public</b> directory to the GitHub Pages site for this repository. The
site should then be available at <b><i>username</i>.github.io</b>.
</p>

<p>
All of that may sound a little complicated, with CI yaml invocations
of virtual machines, build scripts and whatnot. But once you've
wrapped your head around it once and got it set up, it's all fully
automated from them on.
</p>
</div>
</div>


<div id="outline-container-org5d1a72e" class="outline-2">
<h2 id="org5d1a72e">Custom Domain Name</h2>
<div class="outline-text-2" id="text-org5d1a72e">
<p>
The last little detail on this is how to have a custom domain name
point at the github hosted content. This is actually well documented on github at:
</p>

<ul class="org-ul">
<li><a href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site">Managing a custom domain for your GitHub Pages site</a></li>
</ul>

<p>
You can use those instructions to set up either an APEX name
(e.g. <b>example.com</b>) or a subdomain (e.g. <b>foo.example.com</b>). The main
caveat to be aware of is that when you first configure the domain name
on github's Settings page, you should wait 24 hours or so before
turning on https enforcing. Even in this day and age, DNS propagation
can take a while, and that all has to be working correctly and
distributed out before the https setting will work.
</p>

<p>
If you need somewhere to register a domain, I've had good luck with <a href="https://namecheap.com">namecheap</a> and <a href="https://porkbun.com/">porkbun</a>.
</p>
</div>
</div>


<div id="outline-container-org2f14343" class="outline-2">
<h2 id="org2f14343">Worth It?</h2>
<div class="outline-text-2" id="text-org2f14343">
<p>
If you've never used Emacs and/or org-mode, it might seem like a <b>lot</b>
of upfront work to get over the mountain of Emacs just so you can
easily manage the molehill of pushing out website updates.
</p>

<p>
I actually came to Emacs after roughly 20 years of using joe (<a href="https://joe-editor.sourceforge.io/">Joe's
Own Editor</a>), and some of my muscle memory for text editing was so
deeply ingrained that I had to customize emacs to mimic many of joe's
keystrokes.
</p>

<p>
But whatever path you take to get to Emacs, it will almost certainly
be worth it. If you are an engineer, developer, or other technical
user, Emacs (plus Org-mode, dired, mu4e, git/magit, etc., etc.) is
just such a powerful tool that is worth learning to use well. If the
path happens to start with wanting to manage a website in Org-mode,
there are worse ways to begin the journey.
</p>

<p>
And once it is all in place, you can push changes or new content to a
site so quickly that it becomes almost second nature.
</p>
</div>
</div>


<div id="outline-container-orgcd79f5d" class="outline-2">
<h2 id="orgcd79f5d">Resources</h2>
<div class="outline-text-2" id="text-orgcd79f5d">
<p>
The amazing <a href="https://systemcrafters.net/">System Crafters</a> website has a whole series of videos
related to Emacs, and a section devoted to website publishing with
Emacs:
</p>

<ul class="org-ul">
<li><a href="https://systemcrafters.net/publishing-websites-with-org-mode/building-the-site">Build Your Website with Org Mode</a></li>
<li><a href="https://systemcrafters.net/publishing-websites-with-org-mode/automated-site-publishing/">Automated Org Mode Website Publishing with GitHub or SourceHut</a></li>
</ul>

<p>
The above link covers using ox-publish quite extensively, and if you
examine the setup they walk through, you'll see it was the source for
a lot of what I implemented.
</p>

<p>
There's also another guide to using ox-publish on the Org-mode website
here:
</p>

<ul class="org-ul">
<li><a href="https://orgmode.org/worg/org-tutorials/org-publish-html-tutorial.html">Publishing Org-mode files to HTML</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: September  9, 2024</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 29.3 (<a href="https://orgmode.org">Org</a> mode 9.6.15)</p>
</div>
</body>
</html>
